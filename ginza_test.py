# coding: UTF-8
import spacy
import jaconv

# https://oji.netlify.app/ ã‚ˆã‚Š
# input = 'ãªã¿ãƒãƒ£ãƒ³ã€ãŠç–²ã‚Œæ§˜ã€œğŸ˜ƒğŸ˜š(^Ğ·<)ï¼ˆç¬‘ï¼‰ä»Šæ—¥ã¯èŒ¨åŸ28åº¦ã ã‚ˆğŸ’”(^_^;(ï¿£Ğ”ï¿£ï¼›ï¼›(â— ï¼¿â—;)æš‘ã„ã‚ˆğŸ’”ãƒ¤ã‚±ãƒ‰ã—ãªã„ã‚ˆã†ã«æ°—ã‚’ã¤ã‘ãªã„ã¨ãƒğŸ˜ƒâ™¥ â—'
# input = 'ã‚¿ãƒã‚ªï¾ï½¬ï¾ã€ãƒ¤ãƒƒãƒ›ãƒ¼ï¼ˆç¬‘ï¼‰ğŸ˜šä½•ã—ã¦ã‚‹ã®ã‹ã„â‰æ—©ãä¼šã„ãŸã„ãªâ—ğŸ˜ƒâ˜€ ğŸ˜(^o^)'
# input = 'å½©ä¸–ã¡ã‚ƒã‚“ã¯ã€ãŠè‚ŒãŒãã‚Œã„âœ¨ãƒ€ãƒğŸµ(^Ğ·<)ä»Šã‹ã‚‰å¯ã‚ˆã†ã¨æ€ã£ã¦ãŸã®ã«ã€ç›®ãŒè¦šã‚ã¡ã‚ƒã£ãŸã‚ˆğŸ˜ƒâœ‹ğŸ˜ƒâ™¥ ã©ã†ã—ã¦ãã‚Œã‚‹ã‚“ãƒ€ğŸ˜˜ğŸ˜ƒâœ‹(^o^)ğŸ˜š'
# input = 'ãŠã¯ã‚ˆãƒ¼ï¼ãƒãƒ¥ãƒƒğŸ˜ƒâ™¥ (^o^)ğŸ˜ƒğŸµæœ¬æ—¥ã®ãƒ©ãƒ³ãƒğŸ´ã¯å¥®ç™ºã—ã¦ã‚µãƒ©ãƒ€ä»˜ãï¼ˆç¬‘ï¼‰ğŸµğŸ˜„ğŸ’—èª°ã ãƒ¡ã‚¿ãƒœãªã‚“ã¦è¨€ã£ãŸã‚„ã¤ã¯(^â–½^;)^^;(ï¿£Ğ”ï¿£ï¼›ï¼›ğŸ’¦'
# input = 'ã‚¨ãƒªãƒŠã¡ã‚ƒã‚“ã€å¯æ„›ã‚‰ã—ã‚¤ãƒâ—ğŸ˜ƒãƒ›ãƒ³ãƒˆå¯æ„›ã™ãã ã‚ˆã€œ(^_^)ğŸ˜†ğŸ’—ãƒãƒƒã‚¿ã‚¯ã‚‚ã†(^_^)ğŸ˜ƒâ˜€'
input = 'ãˆã¿ã¡ã‚ƒã‚“ã€ã“ã‚“ãªé…ã„æ™‚é–“ğŸ˜¤ã«ä½•ã‚’ã—ã¦ã„ã‚‹ã®ã‹ãªâ—â“â‰â“âœ‹â“ä»Šæ—¥ã‚‚é ‘å¼µã£ã¦ã­ğŸ˜ƒâ™¥ ğŸ˜ƒâ˜€ ğŸ˜š'
output = ''

nlp = spacy.load('ja_ginza')
doc = nlp(input)
for sent in doc.sents:
    for token in sent:
        target = token.orth_

        # åŠè§’ï½¶ï¾…ã¯ã‚­ãƒ¢ã„ã®ã§å…¨è§’ã«
        target = jaconv.h2z(target)

        if token.dep_ == 'dep' and token.head.i == 37:
            target = ''

        # ãã‚Œä»¥å¤–ã®è¨˜å·ã¯ï¼ã«å¤‰ãˆã¡ã‚ƒã†
        if 'è¨˜å·' in token.tag_:
            target = 'ï¼'

        # ã‚ˆã‚Šã‚­ãƒ¢ãã†ãªé¡”æ–‡å­—ã¨ã‹ã®è¨˜å·ã ã£ãŸã‚‰ç„¡è¦–
        if 'è£œåŠ©è¨˜å·' in token.tag_:
            target = ''

        # ç©ºç™½æ‰±ã„ã®æ–‡å­—ã¯ã‚ˆãã‚ã‹ã‚‰ãªã„ã®ã§ï¼ã«ã—ã¡ã‚ƒã†
        if 'ç©ºç™½' in token.tag_:
            target = 'ï¼'

        # æ•¬ç§°ã¯ã²ã‚‰ãŒãªã«ã€‚ãã‚‚ãã‚‚ãƒãƒ£ãƒ³ã¨ã‹ã©ã†ãªã®ã¨ã‚‚æ€ã†ã‘ã©
        if 'æ¥å°¾è¾-åè©çš„-ä¸€èˆ¬' in token.tag_:
            target = jaconv.kata2hira(target)

        # çµ‚åŠ©è©ãŒã‚«ã‚¿ã‚«ãƒŠã«ãªã£ã¦ãŸã‚‰ã²ã‚‰ãŒãªã«æˆ»ã—ã¦ã‚„ã‚‹
        if 'çµ‚åŠ©è©' in token.tag_ or 'åŠ©å‹•è©' in token.tag_:
            target = jaconv.kata2hira(target)

        # ãªã‚“ã¨ãªãâ— ã¯ï¼ã«å¤‰æ›ã—ãŸã„
        if 'â—' == target:
            target = 'ï¼'

        # print(
        #     token.i,
        #     token.orth_,
        #     token.lemma_,
        #     token.norm_,
        #     token.morph.get("Reading"),
        #     token.pos_,
        #     token.morph.get("Inflection"),
        #     token.tag_,
        #     token.dep_,
        #     token.head.i,
        # )
        output = output + target

print('å…¥åŠ›: ' + input)
print('å‡ºåŠ›: ' + output)
